<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>簡單雙面板拖拽介面</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- 使用既有的 CSS 樣式 -->
    <link rel="stylesheet" href="src/style/index.css">
    <link rel="stylesheet" href="src/style/page.css">
	<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=3.111.0&features=es2017%2Ces2018%2Ces2019%2Ces6"></script>
</head>
<body>
	<!-- 頂部導航 -->
	<div class="top-nav py-2">
		<div class="container">
			<div class="row justify-content-between align-items-center">
				<div class="col-auto">
					<span>台北自來水事業處</span>
				</div>
				<div class="col-auto">
					<div class="d-flex gap-3">
						<a href="#" class="text-decoration-none">系統說明</a>
						<a href="#" class="text-decoration-none">操作手冊</a>
						<a href="#" class="text-decoration-none">聯絡我們</a>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<!-- 主導航 -->
	<header class="main-header">
		<div class="main-header-title">
			<div class="logo me-2">💧</div>
			<div class="site-name">水網監測平台</div>
		</div>
		<div class="row justify-content-between align-items-center h-100 px-3">
			<div class="col-auto">
				<div class="d-flex align-items-center">
					<div class="dropdown me-3">
						<button class="btn btn-light border dropdown-toggle" type="button" data-bs-toggle="dropdown"
							aria-expanded="false" style="border: 2px solid var(--primary-color)!important"><i
								class="fa-solid fa-table me-1"></i>主題選擇</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'list')">
									<div class="badge bg-primary me-1">列表</div>供水
								</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'list')">
									<div class="badge bg-primary me-1">列表</div>淨水
								</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'list')">
									<div class="badge bg-primary me-1">列表</div>水質
								</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'list')">
									<div class="badge bg-primary me-1">列表</div>分區計量
								</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'list')">
									<div class="badge bg-primary me-1">列表</div>大表計量
								</a></li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'map')">地圖</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'PID')">圖譜</a></li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'surround')">環景</a></li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li><a class="dropdown-item" href="#" onclick="switchTheme('panel1', 'map')">緊急應變圖台</a></li>
						</ul>
					</div>
					<div class="search-wrapper" style="width: 250px;">
						<input type="text" class="form-control pe-5" placeholder="搜尋監測站點、水質數據..." id="searchInput">
						<button class="search-btn">
							<i class="fas fa-search"></i>
						</button>
					</div>
				</div>
			</div>
			<div class="col-auto d-none d-sm-block">
				<span id="panel1-width">50%</span>/
				<span id="panel2-width">50%</span>
				<button class="btn btn-primary btn-sm" onclick="resetPanels()">重置Config寬度</button>
			</div>
		</div>
	</header>
	<div class="main-content">
		<div id="panel-wrapper">
			<div id="panel1">
				<!-- Panel 1 - List Theme -->
				<div id="panel1-list" class="panel-container" data-theme="list">
					<div class="panel-header">
						<div class="panel-title">
							<button class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#panel1-list-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm js-open-panel2-btn" type="button" title="開啟輔助面板" onclick="showPanel2()">
								<i class="fas fa-window-restore me-1"></i>輔助面板
							</button>
						</div>
					</div>
					<div id="panel1-list-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">站點</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-list-station-filter">
										<option value="">所有站點</option>
										<option value="北區">北區</option>
										<option value="南區">南區</option>
										<option value="東區">東區</option>
										<option value="西區">西區</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">時間範圍</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-list-time-filter">
										<option value="">所有時間</option>
										<option value="today">今天</option>
										<option value="week">本週</option>
										<option value="month">本月</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">狀態</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-list-status-filter">
										<option value="">所有狀態</option>
										<option value="normal">正常</option>
										<option value="warning">警告</option>
										<option value="error">錯誤</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel1-list-content" class="panel-content" style="background-color: lightseagreen;"></div>
				</div>
	
				<!-- Panel 1 - Map Theme -->
				<div id="panel1-map" class="panel-container" data-theme="map" style="display: none;">
					<div class="panel-header">
						<div class="panel-title">
							<button class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#panel1-map-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm js-open-panel2-btn" type="button" title="開啟輔助面板" onclick="showPanel2()">
								<i class="fas fa-window-restore me-1"></i>輔助面板
							</button>
						</div>
					</div>
					<div id="panel1-map-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">圖層</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-map-layer-filter">
										<option value="">所有圖層</option>
										<option value="water">供水設施</option>
										<option value="pipe">管線</option>
										<option value="station">監測站</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">區域</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-map-area-filter">
										<option value="">所有區域</option>
										<option value="north">北區</option>
										<option value="south">南區</option>
										<option value="east">東區</option>
										<option value="west">西區</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel1-map-content" class="panel-content" style="background-color: lightpink;"></div>
				</div>
	
				<!-- Panel 1 - PID Theme -->
				<div id="panel1-PID" class="panel-container" data-theme="PID" style="display: none;">
					<div class="panel-header">
						<div class="panel-title">
							<button class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#panel1-PID-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm js-open-panel2-btn" type="button" title="開啟輔助面板" onclick="showPanel2()">
								<i class="fas fa-window-restore me-1"></i>輔助面板
							</button>
						</div>
					</div>
					<div id="panel1-PID-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">圖譜類型</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-PID-type-filter">
										<option value="">所有類型</option>
										<option value="flow">流程圖</option>
										<option value="network">網路圖</option>
										<option value="system">系統圖</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel1-PID-content" class="panel-content" style="background-color: lightskyblue;"></div>
				</div>
	
				<!-- Panel 1 - Surround Theme -->
				<div id="panel1-surround" class="panel-container" data-theme="surround" style="display: none;">
					<div class="panel-header">
						<div class="panel-title">
							<button class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#panel1-surround-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm js-open-panel2-btn" type="button" title="開啟輔助面板" onclick="showPanel2()">
								<i class="fas fa-window-restore me-1"></i>輔助面板
							</button>
						</div>
					</div>
					<div id="panel1-surround-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">視點</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel1-surround-viewpoint-filter">
										<option value="">所有視點</option>
										<option value="station1">監測站1</option>
										<option value="station2">監測站2</option>
										<option value="station3">監測站3</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel1-surround-content" class="panel-content" style="background-color: yellowgreen;"></div>
				</div>
			</div>
			<!-- Resizer -->
			<div class="resizer">
				<div id="panel-resizer" class="w-100 h-100"></div>
				<div class="resizer-line"></div>
				<div class="sync-btn"><i class="fa-solid fa-link"></i></div>
			</div>
			
			<div id="panel2">
				<!-- Panel 2 - List Theme -->
				<div id="panel2-list" class="panel-container" data-theme="list" style="display: none;">
					<div class="panel-header">
						<div class="panel-title">
							輔助視窗：
							<select class="form-select form-select-sm theme-selector ms-2" id="panel2-theme-selector-list" onchange="switchTheme('panel2', this.value)" style="width: auto;">
								<option value="list" selected>列表</option>
								<option value="map">地圖</option>
								<option value="PID">圖譜</option>
								<option value="surround">環景</option>
							</select>
							<button class="btn btn-light ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#panel2-list-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm" type="button" title="隱藏輔助面板" onclick="closePanel2()">
								<i class="fas fa-chevron-right me-1"></i>隱藏
							</button>
						</div>
					</div>
					<div id="panel2-list-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">站點</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-list-station-filter">
										<option value="">所有站點</option>
										<option value="北區">北區</option>
										<option value="南區">南區</option>
										<option value="東區">東區</option>
										<option value="西區">西區</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">時間範圍</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-list-time-filter">
										<option value="">所有時間</option>
										<option value="today">今天</option>
										<option value="week">本週</option>
										<option value="month">本月</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">狀態</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-list-status-filter">
										<option value="">所有狀態</option>
										<option value="normal">正常</option>
										<option value="warning">警告</option>
										<option value="error">錯誤</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel2-list-content" class="panel-content" style="background-color: lightseagreen;"></div>
				</div>
	
				<!-- Panel 2 - Map Theme -->
				<div id="panel2-map" class="panel-container" data-theme="map">
					<div class="panel-header">
						<div class="panel-title">
							輔助視窗：
							<select class="form-select form-select-sm theme-selector ms-2" id="panel2-theme-selector-map" onchange="switchTheme('panel2', this.value)" style="width: auto;">
								<option value="list">列表</option>
								<option value="map" selected>地圖</option>
								<option value="PID">圖譜</option>
								<option value="surround">環景</option>
							</select>
							<button class="btn btn-light ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#panel2-map-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm" type="button" title="隱藏輔助面板" onclick="closePanel2()">
								<i class="fas fa-chevron-right me-1"></i>隱藏
							</button>
						</div>
					</div>
					<div id="panel2-map-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">圖層</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-map-layer-filter">
										<option value="">所有圖層</option>
										<option value="water">供水設施</option>
										<option value="pipe">管線</option>
										<option value="station">監測站</option>
									</select>
								</div>
								<label class="col-auto form-label text-sm">區域</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-map-area-filter">
										<option value="">所有區域</option>
										<option value="north">北區</option>
										<option value="south">南區</option>
										<option value="east">東區</option>
										<option value="west">西區</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel2-map-content" class="panel-content" style="background-color: lightpink;"></div>
				</div>
	
				<!-- Panel 2 - PID Theme -->
				<div id="panel2-PID" class="panel-container" data-theme="PID" style="display: none;">
					<div class="panel-header">
						<div class="panel-title">
							輔助視窗：
							<select class="form-select form-select-sm theme-selector ms-2" id="panel2-theme-selector-PID" onchange="switchTheme('panel2', this.value)" style="width: auto;">
								<option value="list">列表</option>
								<option value="map">地圖</option>
								<option value="PID" selected>圖譜</option>
								<option value="surround">環景</option>
							</select>
							<button class="btn btn-light ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#panel2-PID-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm" type="button" title="隱藏輔助面板" onclick="closePanel2()">
								<i class="fas fa-chevron-right me-1"></i>隱藏
							</button>
						</div>
					</div>
					<div id="panel2-PID-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">圖譜類型</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-PID-type-filter">
										<option value="">所有類型</option>
										<option value="flow">流程圖</option>
										<option value="network">網路圖</option>
										<option value="system">系統圖</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel2-PID-content" class="panel-content" style="background-color: lightskyblue;"></div>
				</div>
				<!-- Panel 2 - Surround Theme -->
				<div id="panel2-surround" class="panel-container" data-theme="surround" style="background-color: lightskyblue;">
					<div class="panel-header">
						<div class="panel-title">
							輔助視窗：
							<select class="form-select form-select-sm theme-selector ms-2" id="panel2-theme-selector-surround" onchange="switchTheme('panel2', this.value)" style="width: auto;">
								<option value="list">列表</option>
								<option value="map">地圖</option>
								<option value="PID">圖譜</option>
								<option value="surround" selected>環景</option>
							</select>
							<button class="btn btn-light ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#panel2-surround-filter" aria-expanded="false">
								<i class="fas fa-cog me-1"></i>選項
							</button>
						</div>
						<div class="panel-controls">
							<button class="btn btn-light btn-sm" type="button" title="隱藏輔助面板" onclick="closePanel2()">
								<i class="fas fa-chevron-right me-1"></i>隱藏
							</button>
						</div>
					</div>
					<div id="panel2-surround-filter" class="panel-filter collapse">
						<div class="p-2 border-bottom bg-light">
							<div class="row g-2 align-items-center">
								<label class="col-auto form-label text-sm">視點</label>
								<div class="col-auto">
									<select class="form-select form-select-sm" id="panel2-surround-viewpoint-filter">
										<option value="">所有視點</option>
										<option value="station1">監測站1</option>
										<option value="station2">監測站2</option>
										<option value="station3">監測站3</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div id="panel2-surround-content" class="panel-content" style="background-color: yellowgreen;"></div>
				</div>
			</div>
		</div>
	</div>
		
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.3/js/dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.3/js/dataTables.bootstrap5.min.js"></script>
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/dataTables.fixedColumns.min.js"></script>
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/fixedColumns.bootstrap5.min.js"></script>
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.3/css/dataTables.bootstrap5.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/5.0.4/css/fixedColumns.bootstrap5.min.css">
    <script type="module" src="./src/js/AppController.js"></script>

	<script>
		// ✅ 監聽 AppController 初始化完成事件
		window.addEventListener('appControllerReady', function () {
			// 定義回調函式
			function mySyncCallback(isSync) {
				console.log('sync callback:', isSync);
			}
			function haha() {
				console.log('haha');
			}

			// 註冊回調
			window.onSyncChange(mySyncCallback);
			window.onSyncChange(haha);
		});
	</script>
</body>
</html>